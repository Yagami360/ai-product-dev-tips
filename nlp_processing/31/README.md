# LLM 学習方法の基礎事項

- トークン化

- 位置エンコーディング

- Pre-Training（事前学習）
    LLM を大規模学習用データセットで学習し、LLMに基本的な言語能力を獲得させる学習フェイズ。
    基本的には、自己教師あり学習で学習が行われる
    自己教師あり学習には、以下のような方法が存在する

    - 自己回帰言語モデリング (AR: Auto-regressive Language Modeling)<br>
        GPT などで使用されている自己教師あり学習手法。<br>
        与えられた文脈（これまでの単語列）から次の単語やトークンを予測する自己教師あり学習の手法。<br>

        具体的には、以下のような形式で学習用データセットを作成して、モデルに学習させる

        ```text
        元データ: 人工知能は様々な分野で活用されています。例えば、医療、金融、教育などです。

        学習用データ例:
        前置文脈（LLMへの入力データ）: 「人工」 → 次トークン（正解データ）: 「知能」
        前置文脈（LLMへの入力データ）: 「人工知能」 → 次トークン（正解データ）: 「は」
        前置文脈（LLMへの入力データ）: 「人工知能は」 → 次トークン（正解データ）: 「様々」
        ...
        前置文脈（LLMへの入力データ）: 「人工知能は様々な分野で活用されています。例えば、医療、金融」 → 次トークン（正解データ）: 「、」
        前置文脈（LLMへの入力データ）: 「人工知能は様々な分野で活用されています。例えば、医療、金融、」 → 次トークン（正解データ）: 「教育」
        ```

    - マスク言語モデリング (MLM: Masked Language Modeling)
        BERT などで使用されている自己教師あり学習手法。<br>
        テキスト中のランダムな一部の文字をマスクし（[MASK]などの特殊トークンで置き換える）、マスクした文字を実際の文字として予測させる自己教師あり学習の手法。<br>

        具体的には、以下のような形式で学習用データセットを作成して、モデルに学習させる

        ```text
        元データ：私はデパートに行って買い物をしました。
        LLMへの入力データ: 私は[MASK]に行って買い物をしました。
        正解データ（教師データ）: 「デパート」

        元データ：彼は水を飲んで喉の渇きを癒しました。
        LLMへの入力データ: 彼は[MASK]を飲んで喉の渇きを癒しました。
        正解データ（教師データ）: 「水」

        元データ：私は昨日、新しいスマートフォンを購入しました。
        LLMへの入力データ: 私は昨日、新しい[MASK]を購入しました。
        正解データ（教師データ）: 「スマートフォン」
        ```


- Post-Training（事後学習）
    Pre-training で学習した LLM に対して、追加の学習を行って特定のタスクに対して最適化を行う学習フェイズで、以下のような学習方法がある

    - SFT [Supervised Fine-Tuning]（教師あり学習）でのファインチューニング

    - RLHF [Reinforcement Learning from Human Feedback] での強化学習

    - アラインメント

- 教師あり学習での学習用データセットと自己教師あり学習での学習用データセットの違い<br>
    教師あり学習での学習用データセットの形式は、以下のように正解データ（教師データ）が存在する

    - 質問応答タスク用データセット
        ```json
        {
        "context": "東京は1868年に江戸から改名され、1869年に日本の首都になりました。",
        "question": "東京はいつ首都になりましたか？",
        "answer": "1869年"
        }
        ```

    - テキスト要約タスク用データセット
        ```json
        {
        "document": "2023年、人工知能の発展は加速し続けた。特に大規模言語モデルは多くの産業で応用され、生産性向上に貢献した。一方でAI倫理や規制についての議論も活発化した。...(長文)",
        "summary": "2023年にはAI技術、特に大規模言語モデルの発展と応用が進み、同時に倫理や規制の議論も高まった。"
        }
        ```

    一方で、自己教師あり学習での学習用データセットの形式は、以下のように正解データ（教師データ）が存在しない。正解データが不要なので、大量のデータセット作成が容易であるメリットがある

    - テキストコーパス
        ```json
        {
        "text": "2023年、人工知能の発展は加速し続けた。特に大規模言語モデルは多くの産業で応用され、生産性向上に貢献した。一方でAI倫理や規制についての議論も活発化した。...(長文)"
        }
        ```