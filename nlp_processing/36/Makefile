# uvã‚’ä½¿ç”¨ã—ãŸMCPã‚µãƒ¼ãƒãƒ¼ã®ç®¡ç†ç”¨Makefile

.PHONY: install setup-cursor run lint format format-check

# uvã§ã®ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
install:
	uv lock --upgrade
	uv sync --extra dev

# Cursor MCP è¨­å®šã®é©ç”¨
setup-cursor:
	@echo "âš™ï¸  Cursor MCPè¨­å®šã‚’é©ç”¨ä¸­..."
	@CURSOR_CONFIG_DIR="$(HOME)/.cursor"
	@mkdir -p "$$CURSOR_CONFIG_DIR"
	@if [ -f "$$CURSOR_CONFIG_DIR/mcp_config.json" ]; then \
		cp "$$CURSOR_CONFIG_DIR/mcp_config.json" \
		   "$$CURSOR_CONFIG_DIR/mcp_config.json.backup.$$(date +%Y%m%d_%H%M%S)"; \
		echo "   æ—¢å­˜è¨­å®šã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸ"; \
	fi
	@cp cursor_mcp_config.json "$$CURSOR_CONFIG_DIR/mcp_config.json"
	@echo "   Cursor MCPè¨­å®šã‚’æ›´æ–°ã—ã¾ã—ãŸ"
	@echo "   è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«: $$CURSOR_CONFIG_DIR/mcp_config.json"

# MCPã‚µãƒ¼ãƒãƒ¼å®Ÿè¡Œ
run: install
	@echo "ğŸ§ª MCPã‚µãƒ¼ãƒãƒ¼èµ·å‹•ä¸­..."
	@echo "Ctrl+C ã§åœæ­¢ã§ãã¾ã™"
	uv run python mcp_server.py

# Run code linting
lint: install
	uv run flake8 .
	uv run mypy .

# Run code formatting
format: install
	uv run black .
	uv run isort .

# Run code formatting check
format-check: install
	uv run black --check .
	uv run isort --check-only .
